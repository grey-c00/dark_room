# Questions

Write a query to check if a table contains any records
Write a query to fetch alternating rows from a table.
Write a query to find departments with the highest average salary.
Write a query to fetch the nth record from a table.
Find the second highest salary without using LIMIT, OFFSET, or TOP.
Identify customers who made transactions in every month of the year.
Calculate the 7-day moving average of sales for each product.
Calculate the 7-day moving average of sales for each product, some of the dates might be missing
Find users who logged in for at least three consecutive days.
Find the max streak of action (logging, logout, etc) for a user in a given year
Use window functions to rank orders by order value per customer and return the top 3.
Retrieve employees who earn more than their managers.
Find duplicate rows in a large table and delete only the extras.
Optimize a slow-performing query with multiple joins and aggregations.
Get the first order for each customer, handling tie-breakers properly.
Find products never purchased by any customer.
Retrieve users who made purchases in 2 consecutive months but not the 3rd.
Find the department with the highest total salary payout.
Identify employees with the same salary in the same department.
Calculate median salary without using built-in functions.
Write a query to pivot rows into monthly sales columns.
Identify top N customers with the highest total purchases (with tie handling).
Get the running total of revenue per day using window functions.
Find users whose most frequently purchased category in the last year is ‘Electronics’.
Retrieve the first and last event for each user from an events table.
Rank products by yearly sales, resetting rank every new year.
1.⁠ ⁠Compute YoY growth in revenue per customer
2.⁠ ⁠Find suppliers with stock < 50 for 2+ consecutive days
3.⁠ ⁠Rank employees by total sales per store for 2023
4.⁠ ⁠Get customers who placed orders from 3 different locations in 10 days
5.⁠ ⁠Find top 5 busiest restaurants by orders per day
6.⁠ ⁠Retrieve the last successful payment per user
7.⁠ ⁠Pivot rider onboarding data into month-wise columns
8.⁠ ⁠Find restaurants with 4+ star ratings consistently for 6 months
9.⁠ ⁠Compare revenue trends between premium and regular users MoM
10.⁠ ⁠Detect schema drift in historical feedback JSON data
11.⁠ ⁠Find delivery partners with 50+ deliveries but none in last 30 days
12.⁠ ⁠Identify users who ordered on all Sundays in the past month
13.⁠ ⁠Rank dishes by popularity in each cuisine by month
14.⁠ ⁠Find duplicate user accounts using phone/email matching
15.⁠ ⁠Get top cities with most delivery delays during peak hours
16.⁠ ⁠Calculate 7-day moving average of total order value per city
17.⁠ ⁠Find customers whose first and last order are on the same day
18.⁠ ⁠List customers who ordered from 3+ cuisines in the same week
19.⁠ ⁠Detect failed orders that later succeeded on retry
20.⁠ ⁠Identify login streaks of 3+ days for active users